{"version":3,"sources":["components/TableRowCell/TableRowCell.module.css","components/TableRow/TableRow.module.css","components/TableHead/TableHead.module.css","components/ToggleLink/ToggleLink.module.css","themes/themes.module.css","models/models.ts","utils/utils.tsx","components/TableRowCell/TableRowCell.tsx","components/TableRowCellSimple/TableRowCellSimple.tsx","components/TableRow/TableRow.tsx","components/TableHead/TableHead.tsx","components/Table/Table.tsx","components/ToggleLink/ToggleLink.tsx","pages/PageExchangeQuotes/layout/PageExchangeQuotesLayout.tsx","services/service-websocket.ts","pages/PageExchangeQuotes/hooks/useProps.tsx","hooks/use-body-class/useBodyClass.tsx","pages/PageExchangeQuotes/PageExchangeQuotes.tsx","App.tsx","index.tsx","pages/PageExchangeQuotes/layout/PageExchangeQuotesLayout.module.css"],"names":["module","exports","SortTypeEnum","SortOrderEnum","formatValue","value","String","Number","toFixed","useIsVisible","require","TableRowCell","id","groupId","allowComparing","nodeRef","useRef","isVisible","prevValue","useEffect","current","isMore","className","styles","more","less","setTimeout","ref","React","memo","TableRowCellSimple","TableRow","rowData","root","ticker","bid","ask","high","low","last","TableHead","sortType","sortOrder","onSort","buildClassName","currentType","cn","ASC","DESC","buildClassNameHOF","handleClick","currentSortType","onClick","TICKER","BID","ASK","HIGH","LOW","LAST","Table","data","cellPadding","cellSpacing","_","ToggleLink","showPrimary","onToggle","primaryText","secondText","PageExchangeQuotesLayout","showAllToggle","table","themeToggle","wrapper","header","ServiceWebsocket","url","requestId","requestResolvers","socket","currenciesStore","callbacks","onChange","fn","push","offChange","idx","indexOf","splice","handleOpen","a","getSymbols","result","forEach","currencies","subscribeTicker","catch","e","console","warn","handleMessage","msg","JSON","parse","method","response","params","symbol","callback","makeRequest","send","stringify","Promise","resolve","this","WebSocket","addEventListener","useProps","limit","useState","theme","themes","lightTheme","state","setState","tmp","requestRef","previousTimeRef","animate","useCallback","time","prev","requestAnimationFrame","cancelAnimationFrame","handleChangeTicker","baseCurrency","feeCurrency","parseFloat","transform","serviceWebsocket","filteredData","useMemo","map","sortBy","obj","reverse","slice","thru","arr","handleSort","handleLimitToggle","undefined","isLightTheme","handleThemeToggle","darkTheme","onLimitToggle","onThemeToggle","useBodyClass","document","body","classList","add","remove","PageExchangeQuotes","App","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.fccfa063.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"more\":\"TableRowCell_more__m1jO0\",\"less\":\"TableRowCell_less__3EWMv\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"root\":\"TableRow_root__38SN5\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"root\":\"TableHead_root__fMwGM\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"root\":\"ToggleLink_root__3P_3e\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"lightTheme\":\"themes_lightTheme__3p73V\",\"darkTheme\":\"themes_darkTheme__3K45N\"};","type FloatAsString = string;\ntype IntAsString = string;\ntype ISO = string;\n\nexport interface Currencies {\n  baseCurrency: string;\n  feeCurrency: string;\n  id: string;\n  provideLiquidityRate: FloatAsString;\n  quantityIncrement: IntAsString;\n  quoteCurrency: string;\n  takeLiquidityRate: FloatAsString;\n  tickSize: FloatAsString;\n}\n\nexport interface GetSymbolsResponse {\n  id: number;\n  jsonrpc: string;\n  result: Array<Currencies>;\n}\n\nexport interface SuccessfulSubscribingResponse {\n  id: number;\n  jsonrpc: string;\n  result: boolean;\n}\n\nexport interface Ticker {\n  ask: FloatAsString;\n  bid: FloatAsString;\n  high: FloatAsString;\n  last: FloatAsString;\n  low: FloatAsString;\n  open: FloatAsString;\n  symbol: string;\n  timestamp: ISO;\n  volume: FloatAsString;\n  volumeQuote: FloatAsString;\n}\n\nexport interface ReceivedNotification<T> {\n  jsonrpc: string;\n  method: string;\n  params: T;\n}\n\nexport interface TableRowData {\n  id: string;\n  ticker: string;\n  bid: number;\n  ask: number;\n  high: number;\n  low: number;\n  last: number;\n}\n\nexport enum SortTypeEnum {\n  TICKER = 'id',\n  BID = 'bid',\n  ASK = 'ask',\n  HIGH = 'high',\n  LOW = 'low',\n  LAST = 'last',\n}\n\nexport enum SortOrderEnum {\n  ASC = 'asc',\n  DESC = 'desc',\n}\n","import { Currencies, TableRowData, Ticker } from '../models/models';\n\nexport const transform = (currencies: Currencies, data: Ticker): TableRowData => {\n  return {\n    id: currencies.id,\n    ticker: `${currencies.baseCurrency} / ${currencies.feeCurrency}`,\n    bid: parseFloat(data.bid),\n    ask: parseFloat(data.ask),\n    high: parseFloat(data.high),\n    last: parseFloat(data.last),\n    low: parseFloat(data.low),\n  };\n};\n\nexport const debug = (...args: string[]) => {\n  console.log.apply(console, args);\n};\n\nexport const formatValue = (value: string | number | null): string => {\n  if (!value) return '—';\n  if (typeof value === 'string') return value;\n  if (value > 0.000001) return String(value);\n  return Number(value).toFixed(10);\n};\n","import React, { useEffect, useRef } from 'react';\nimport { formatValue } from '../../utils/utils';\nimport styles from './TableRowCell.module.css';\n\n// todo ugly ugly because typescript warning\nconst { useIsVisible } = require('react-is-visible');\n\ninterface TableRowProps {\n  id: string;\n  groupId: string;\n  value: string | number;\n  allowComparing?: boolean;\n}\n\nconst TableRowCell: React.FC<TableRowProps> = ({ value, id, groupId, allowComparing = false }) => {\n  const nodeRef = useRef<HTMLTableCellElement>(null);\n  const isVisible = useIsVisible(nodeRef);\n  const prevValue = useRef<string | number>();\n\n  useEffect(() => {\n    if (!allowComparing) return;\n    if (prevValue.current === value) return;\n    if (!isVisible) {\n      prevValue.current = value;\n      return;\n    }\n    if (prevValue.current && nodeRef.current) {\n      const isMore = prevValue.current < value;\n      nodeRef.current.className = isMore ? styles.more : styles.less;\n    }\n    setTimeout(() => {\n      if (nodeRef.current) nodeRef.current.className = '';\n    }, 100);\n    prevValue.current = value;\n  }, [nodeRef, allowComparing, id, groupId, value, isVisible]);\n\n  return <td ref={nodeRef}>{formatValue(value)}</td>;\n};\n\nexport default React.memo(TableRowCell);\n","import React from 'react';\n\ninterface TableRowProps {\n  value: string;\n}\n\nconst TableRowCellSimple: React.FC<TableRowProps> = ({ value }) => {\n  return <td>{value}</td>;\n};\n\nexport default React.memo(TableRowCellSimple);\n","import React from 'react';\nimport { TableRowData } from '../../models/models';\nimport TableRowCell from '../TableRowCell/TableRowCell';\nimport TableRowCellSimple from '../TableRowCellSimple/TableRowCellSimple';\nimport styles from './TableRow.module.css';\n\ninterface TableRowProps {\n  rowData: TableRowData;\n}\n\nconst TableRow: React.FC<TableRowProps> = ({ rowData }) => {\n  return (\n    <tr className={styles.root}>\n      <TableRowCellSimple value={rowData.ticker} />\n      <TableRowCell value={rowData.bid} id=\"bid\" groupId={rowData.id} allowComparing />\n      <TableRowCell value={rowData.ask} id=\"ask\" groupId={rowData.id} allowComparing />\n      <TableRowCell value={rowData.high} id=\"high\" groupId={rowData.id} allowComparing />\n      <TableRowCell value={rowData.low} id=\"low\" groupId={rowData.id} allowComparing />\n      <TableRowCell value={rowData.last} id=\"last\" groupId={rowData.id} allowComparing />\n    </tr>\n  );\n};\n\nexport default React.memo(TableRow);\n","import React from 'react';\nimport styles from './TableHead.module.css';\nimport cn from 'classnames';\nimport { SortOrderEnum, SortTypeEnum } from '../../models/models';\n\ninterface TableHeadProps {\n  sortType: SortTypeEnum;\n  sortOrder: SortOrderEnum;\n  onSort: (type: SortTypeEnum, order: SortOrderEnum) => void;\n}\n\nconst buildClassNameHOF = (sortType: SortTypeEnum, sortOrder: SortOrderEnum) => (currentType: SortTypeEnum) => {\n  if (currentType !== sortType) return;\n  return cn({\n    'fas fa-sort-amount-up': sortOrder === SortOrderEnum.ASC,\n    'fas fa-sort-amount-down': sortOrder === SortOrderEnum.DESC,\n  });\n};\n\nconst TableHead: React.FC<TableHeadProps> = ({ sortType, sortOrder, onSort }) => {\n  const buildClassName = buildClassNameHOF(sortType, sortOrder);\n\n  const handleClick = (currentSortType: SortTypeEnum) => () =>\n    onSort(\n      currentSortType,\n      currentSortType !== sortType\n        ? SortOrderEnum.DESC\n        : sortOrder === SortOrderEnum.DESC\n        ? SortOrderEnum.ASC\n        : SortOrderEnum.DESC,\n    );\n\n  return (\n    <thead>\n      <tr className={styles.root}>\n        <th onClick={handleClick(SortTypeEnum.TICKER)}>\n          Ticker <span className={buildClassName(SortTypeEnum.TICKER)} />\n        </th>\n        <th onClick={handleClick(SortTypeEnum.BID)}>\n          Bid <span className={buildClassName(SortTypeEnum.BID)} />\n        </th>\n        <th onClick={handleClick(SortTypeEnum.ASK)}>\n          Ask <span className={buildClassName(SortTypeEnum.ASK)} />\n        </th>\n        <th onClick={handleClick(SortTypeEnum.HIGH)}>\n          High <span className={buildClassName(SortTypeEnum.HIGH)} />\n        </th>\n        <th onClick={handleClick(SortTypeEnum.LOW)}>\n          Low <span className={buildClassName(SortTypeEnum.LOW)} />\n        </th>\n        <th onClick={handleClick(SortTypeEnum.LAST)}>\n          Last <span className={buildClassName(SortTypeEnum.LAST)} />\n        </th>\n      </tr>\n    </thead>\n  );\n};\n\nexport default React.memo(TableHead);\n","import React from 'react';\nimport * as _ from 'lodash';\nimport { SortOrderEnum, SortTypeEnum, TableRowData } from '../../models/models';\nimport TableRow from '../TableRow/TableRow';\nimport TableHead from '../TableHead/TableHead';\n\nexport interface TablePropsData {\n  [key: string]: TableRowData;\n}\n\ninterface TableProps {\n  data: Array<TableRowData>;\n  sortType: SortTypeEnum;\n  sortOrder: SortOrderEnum;\n  onSort: (type: SortTypeEnum, order: SortOrderEnum) => void;\n}\n\nconst Table: React.FC<TableProps> = ({ data = {}, onSort, sortType, sortOrder }) => {\n  return (\n    <table cellPadding=\"0\" cellSpacing=\"0\">\n      <TableHead onSort={onSort} sortOrder={sortOrder} sortType={sortType} />\n      <tbody>\n        {_.map(data, (rowData: TableRowData, id) => (\n          <TableRow key={rowData.id} rowData={rowData} />\n        ))}\n      </tbody>\n    </table>\n  );\n};\n\nexport default React.memo(Table);\n","import React from 'react';\nimport styles from './ToggleLink.module.css';\n\ninterface ToggleLinkProps {\n  showPrimary: boolean;\n  primaryText: string;\n  secondText: string;\n  onToggle: () => void;\n}\n\nconst ToggleLink: React.FC<ToggleLinkProps> = ({ showPrimary, onToggle, primaryText, secondText }) => {\n  return (\n    <span onClick={onToggle} className={styles.root}>\n      {showPrimary ? primaryText : secondText}\n    </span>\n  );\n};\n\nexport default React.memo(ToggleLink);\n","import React from 'react';\nimport styles from './PageExchangeQuotesLayout.module.css';\n\ninterface PageExchangeQuotesLayoutProps {\n  showAllToggle: React.ReactElement;\n  table: React.ReactElement;\n  themeToggle: React.ReactElement;\n}\n\nconst PageExchangeQuotesLayout: React.FC<PageExchangeQuotesLayoutProps> = ({ showAllToggle, table, themeToggle }) => {\n  return (\n    <div className={styles.root}>\n      <div className={styles.wrapper}>\n        <h1>Exchange Quotes</h1>\n        <div className={styles.header}>\n          {showAllToggle}\n          {themeToggle}\n        </div>\n        {table}\n      </div>\n    </div>\n  );\n};\n\nexport default React.memo(PageExchangeQuotesLayout);\n","import {\n  Currencies,\n  GetSymbolsResponse,\n  ReceivedNotification,\n  SuccessfulSubscribingResponse,\n  Ticker,\n} from '../models/models';\n\ninterface RequestResolversStore {\n  // todo ugly ugly any\n  [key: number]: (value: any) => void;\n}\n\ninterface CurrenciesStore {\n  [key: string]: Currencies;\n}\n\ntype Callback = (currencies: Currencies, data: Ticker) => void;\n\nexport class ServiceWebsocket {\n  private requestId: number = 0;\n  private requestResolvers: RequestResolversStore = {};\n  private socket: WebSocket;\n  private currenciesStore: CurrenciesStore = {};\n  private callbacks: Array<Callback> = [];\n\n  constructor(url: string) {\n    this.socket = new WebSocket(url);\n\n    this.socket.addEventListener('open', this.handleOpen);\n    this.socket.addEventListener('message', this.handleMessage);\n  }\n\n  onChange = (fn: Callback) => {\n    this.callbacks.push(fn);\n  };\n\n  offChange = (fn: Callback) => {\n    const idx = this.callbacks.indexOf(fn);\n    if (idx !== -1) this.callbacks.splice(idx, 1);\n  };\n\n  private handleOpen = async () => {\n    const symbols = await this.getSymbols();\n    symbols.result.forEach((currencies, idx) => {\n      this.currenciesStore[currencies.id] = currencies;\n      this.subscribeTicker(currencies.id).catch(e => {\n        console.warn('No able to make subscription for ' + currencies.id + '. Error: ' + e);\n      });\n    });\n  };\n\n  private handleMessage = (msg: MessageEvent) => {\n    const data = JSON.parse(msg.data);\n    if ('id' in data) {\n      return this.requestResolvers[data.id] && this.requestResolvers[data.id](data);\n    }\n    if ('ticker' === data.method) {\n      const response = data as ReceivedNotification<Ticker>;\n      const currencies = this.currenciesStore[response.params.symbol];\n      this.callbacks.forEach(callback => callback(currencies, response.params));\n    }\n  };\n\n  private getSymbols = (): Promise<GetSymbolsResponse> => this.makeRequest<GetSymbolsResponse>('getSymbols', {});\n\n  private subscribeTicker = (symbol: string): Promise<SuccessfulSubscribingResponse> =>\n    this.makeRequest<SuccessfulSubscribingResponse>('subscribeTicker', { symbol });\n\n  private makeRequest = <T>(method: string, params: {}) => {\n    const id = ++this.requestId;\n    this.socket.send(JSON.stringify({ method, params, id }));\n    return new Promise<T>(resolve => {\n      this.requestResolvers[id] = resolve;\n    });\n  };\n}\n","import React, { useCallback, useEffect, useMemo, useRef, useState } from 'react';\nimport * as _ from 'lodash';\nimport { ServiceWebsocket } from '../../../services/service-websocket';\nimport { TablePropsData } from '../../../components/Table/Table';\nimport { Currencies, SortOrderEnum, SortTypeEnum, TableRowData, Ticker } from '../../../models/models';\nimport { transform } from '../../../utils/utils';\nimport themes from '../../../themes/themes.module.css';\n\ninterface State {\n  data: TablePropsData;\n  sortType: SortTypeEnum;\n  sortOrder: SortOrderEnum;\n  limit?: number;\n  theme: string;\n}\n\ninterface UsePropsReturn extends State {\n  filteredData: Array<TableRowData>;\n  isLightTheme: boolean;\n  onSort: (sortType: SortTypeEnum, sortOrder: SortOrderEnum) => void;\n  onLimitToggle: () => void;\n  onThemeToggle: () => void;\n}\n\n/**\n * All business logic is encapsulated inside of this hook\n * It recalculate and returns props and callbacks for views\n * It also can be covered by test ;-)\n */\nconst useProps = (limit?: number): UsePropsReturn => {\n  const [state, setState] = useState<State>({\n    data: {},\n    sortType: SortTypeEnum.BID,\n    sortOrder: SortOrderEnum.DESC,\n    limit,\n    theme: themes.lightTheme,\n  });\n\n  /**\n   * Animation stuff to minimize re-rendering\n   */\n  const tmp = useRef<TablePropsData>({});\n  const requestRef = React.useRef<number>(0);\n  const previousTimeRef = React.useRef<number>(0);\n\n  const animate = useCallback((time: number) => {\n    const deltaTime = time - previousTimeRef.current;\n    /**\n     * Will be re-rendered every 200 ms\n     */\n    if (deltaTime > 200) {\n      setState(prev => ({ ...prev, data: { ...prev.data, ...tmp.current } }));\n      previousTimeRef.current = time;\n    }\n    requestRef.current = requestAnimationFrame(animate);\n  }, []);\n\n  React.useEffect(() => {\n    requestRef.current = requestAnimationFrame(animate);\n    return () => cancelAnimationFrame(requestRef.current);\n  }, [animate]);\n\n  /**\n   * Websocket initializing stuff\n   * and storing new data into the \"tmp ref\"\n   * to avoid extra re-rendering\n   */\n  const handleChangeTicker = useCallback((currencies: Currencies, data: Ticker) => {\n    const rowData = transform(currencies, data);\n    tmp.current[rowData.id] = rowData;\n  }, []);\n\n  useEffect(() => {\n    const serviceWebsocket = new ServiceWebsocket('wss://api.exchange.bitcoin.com/api/2/ws');\n    serviceWebsocket.onChange(handleChangeTicker);\n\n    return () => serviceWebsocket.offChange(handleChangeTicker);\n  }, [handleChangeTicker]);\n\n  /**\n   * Preparing data for table:\n   * implemented sorting and ordering\n   */\n  const filteredData = useMemo(\n    () =>\n      _.chain<TablePropsData>(state.data)\n        .map()\n        .sortBy(obj => obj.last)\n        .reverse()\n        .slice(0, state.limit)\n        .sortBy(obj => (obj[state.sortType] ? obj[state.sortType] : 0))\n        .thru(arr => {\n          if (state.sortOrder === SortOrderEnum.DESC) arr.reverse();\n          return arr;\n        })\n        .value(),\n    [state],\n  );\n\n  /**\n   * Sorting and ordering stuff\n   */\n  const handleSort = useCallback(\n    (sortType: SortTypeEnum, sortOrder: SortOrderEnum) =>\n      setState(prev => ({\n        ...prev,\n        sortType,\n        sortOrder,\n      })),\n    [],\n  );\n\n  /**\n   * Limit changing stuff\n   */\n  const handleLimitToggle = useCallback(() => {\n    setState(prev => ({\n      ...prev,\n      limit: prev.limit ? undefined : limit,\n    }));\n  }, [limit]);\n\n  /**\n   * Theming stuff\n   */\n  const isLightTheme = state.theme === themes.lightTheme;\n\n  const handleThemeToggle = useCallback(() => {\n    setState(prev => ({\n      ...prev,\n      theme: isLightTheme ? themes.darkTheme : themes.lightTheme,\n    }));\n  }, [isLightTheme]);\n\n  /**\n   * Prepared props for views\n   */\n  return {\n    filteredData,\n    ...state,\n    isLightTheme,\n    onSort: handleSort,\n    onLimitToggle: handleLimitToggle,\n    onThemeToggle: handleThemeToggle,\n  };\n};\n\nexport default useProps;\n","import { useEffect } from 'react';\n\nconst useBodyClass = (className: string) => {\n  useEffect(() => {\n    document.body.classList.add(className);\n\n    return () => {\n      document.body.classList.remove(className);\n    };\n  }, [className]);\n};\n\nexport default useBodyClass;\n","import React from 'react';\nimport Table from '../../components/Table/Table';\nimport ToggleLink from '../../components/ToggleLink/ToggleLink';\nimport PageExchangeQuotesLayout from './layout/PageExchangeQuotesLayout';\nimport useProps from './hooks/useProps';\nimport useBodyClass from '../../hooks/use-body-class/useBodyClass';\n\nconst LIMIT = 50;\n\nfunction PageExchangeQuotes() {\n  const { theme, limit, sortType, sortOrder, filteredData, onLimitToggle, onThemeToggle, isLightTheme, onSort } =\n    useProps(LIMIT);\n\n  useBodyClass(theme);\n\n  return (\n    <PageExchangeQuotesLayout\n      themeToggle={\n        <ToggleLink\n          showPrimary={isLightTheme}\n          primaryText=\"Dark theme\"\n          secondText=\"Light theme\"\n          onToggle={onThemeToggle}\n        />\n      }\n      showAllToggle={\n        <ToggleLink\n          showPrimary={!!limit}\n          onToggle={onLimitToggle}\n          primaryText=\"Show All\"\n          secondText={`Show top ${LIMIT}`}\n        />\n      }\n      table={<Table data={filteredData} sortOrder={sortOrder} sortType={sortType} onSort={onSort} />}\n    />\n  );\n}\n\nexport default React.memo(PageExchangeQuotes);\n","import React from 'react';\nimport PageExchangeQuotes from './pages/PageExchangeQuotes/PageExchangeQuotes';\n\nfunction App() {\n  return (\n    <>\n      <PageExchangeQuotes />\n    </>\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root'),\n);\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"root\":\"PageExchangeQuotesLayout_root__3yjHe\",\"wrapper\":\"PageExchangeQuotesLayout_wrapper__q5U5K\",\"header\":\"PageExchangeQuotesLayout_header__2Sd9s\"};"],"sourceRoot":""}